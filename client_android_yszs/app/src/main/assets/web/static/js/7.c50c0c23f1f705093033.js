webpackJsonp([7],{"+kry":function(t,e){},"2f92":function(t,e){},"7Rvd":function(t,e){},"8DWd":function(t,e){},"972g":function(t,e){},"DU+s":function(t,e){},Lfxl:function(t,e){},Mzxy:function(t,e){},PckH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lC5x"),n=a.n(s),r=a("J0Oq"),i=a.n(r),o=a("Hqhp"),c=a("gyMJ"),d={props:{status:Number,canRefund:{type:Boolean,default:!1},type:{type:String}},data:function(){return{showRefundDialog:!1,refundMsg:""}},mounted:function(){},methods:{cancelOrder:function(){this.$emit("cancelOrder")},continueToPay:function(){this.$emit("continueToPay")},refundOrder:function(){var t=this;return i()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.D)({category:t.type});case 2:t.refundMsg=e.sent,t.$nextTick(function(){t.showRefundDialog=!0});case 4:case"end":return e.stop()}},e,t)}))()},handleConfirm:function(){this.showRefundDialog=!1,this.$emit("refundOrder")},handleCancel:function(){this.showRefundDialog=!1}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-status-btn-group"},[0==t.status?a("span",{staticClass:"order-status-btn status-cancel",on:{click:function(e){return e.stopPropagation(),t.cancelOrder(e)}}},[t._v("取消订单")]):t._e(),t._v(" "),0==t.status?a("span",{staticClass:"order-status-btn status-topay",on:{click:function(e){return e.stopPropagation(),t.continueToPay(e)}}},[t._v("继续支付")]):t._e(),t._v(" "),t.canRefund?a("span",{staticClass:"order-status-btn status-topay",on:{click:function(e){return e.stopPropagation(),t.refundOrder(e)}}},[a("span",[t._v("申请退款")])]):t._e(),t._v(" "),t.canRefund?a("l-dialog",{staticClass:"order-status-btn-group-dialog",attrs:{show:t.showRefundDialog,appendToBody:"",confirmStyle:"",title:"您确认要退款吗",confirmText:"提交申请"},on:{"update:show":function(e){t.showRefundDialog=e},handleConfirm:t.handleConfirm,handleCancel:t.handleCancel}},[a("p",[t._v("退款说明：")]),t._v(" "),a("div",{domProps:{innerHTML:t._s(t.refundMsg)}})]):t._e()],1)},staticRenderFns:[]};var u=a("C7Lr")(d,l,!1,function(t){a("r8BP")},null,null).exports,p=a("OxEx"),f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.fromStationName)+" - "+t._s(t.data.toStationName)+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v(t._s(t.data.queryDate)+" "+t._s(t.data.fromTime)+" 出发")])])},staticRenderFns:[]};var m=a("C7Lr")({props:{data:{}}},f,!1,function(t){a("7Rvd")},null,null).exports,h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.startCity)+" - "+t._s(t.data.endCity)+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v(t._s(t._f("dateTimeFormat")(t.data.startTime))+" 出发")])])},staticRenderFns:[]};var _=a("C7Lr")({props:{data:{}}},h,!1,function(t){a("972g")},null,null).exports,v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.fromStationName)+" - "+t._s(t.data.toStationName)+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v(t._s(t.data.queryDate)+" "+t._s(t.data.fromTime)+" 出发")])])},staticRenderFns:[]};var y=a("C7Lr")({props:{data:{}}},v,!1,function(t){a("+kry")},null,null).exports,C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.fromStationName)+" - "+t._s(t.data.toStationName)+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v(t._s(t.data.queryDate)+" "+t._s(t.data.fromTime)+" 出发")])])},staticRenderFns:[]};var b=a("C7Lr")({props:{data:{}}},C,!1,function(t){a("isZq")},null,null).exports,g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left order-list-item-scenery-wrapper"},[a("span",{staticClass:"order-list-item-name"},[t._v("\n    "+t._s(t.data.goodName)+"\n    "),a("span",{staticClass:"book-count"},[t._v("("+t._s(t.data.bookCount)+"张)")])]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v("限 "+t._s(t.data.queryDate)+" 有效")])])},staticRenderFns:[]};var x=a("C7Lr")({props:{data:{}}},g,!1,function(t){a("Mzxy")},null,null).exports,O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.goodName)+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item-date"},[t._v(t._s(t.data.checkInDate)+"入住 "+t._s(t.data.checkOutDate)+"离店")])])},staticRenderFns:[]};var R=a("C7Lr")({props:{data:{}}},O,!1,function(t){a("DU+s")},null,null).exports,D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list-item-left"},[a("span",{staticClass:"order-list-item-station"},[t._v("\n    "+t._s(t.data.restaurantName+"（"+t.data.specs+"）")+"\n  ")]),t._v(" "),a("span",{staticClass:"order-list-item"},[t._v(t._s("预计到店人数:"+(t.data.customerCount?t.data.customerCount+"人":"不限人数")))]),t._v(" "),a("span",{staticClass:"order-list-item"},[t._v(t._s("预计到店时间:"+t.data.queryDate+" "+t.data.timeQuantum))])])},staticRenderFns:[]};var I=a("C7Lr")({props:{data:{}}},D,!1,function(t){a("2f92")},null,null).exports,w={components:{OrderStatusBtnGroup:u,CommonItem:p.a},props:{data:{},type:{type:String,default:"bus"}},computed:{status:function(){var t=parseInt(this.data.status);return isNaN(t)?-1:t},statusText:function(){return"homestay"===this.type?["未支付","已支付","已取消","退款审核中","已退款","已确认预订"][this.status]:["未支付","已支付","已取消","退票审核中","已退票","已出票"][this.status]},statusClass:function(){return["prepay","paid","cancel","refunding","refunded","issued"][this.status]},canRefund:function(){return this.data.canRefund&&[1,5].indexOf(this.data.status)>-1}},data:function(){return{items:{bus:{component:m,name:"OrderQueryBus"},plane:{component:_,name:"OrderQueryPlane"},train:{component:y,name:"OrderQueryTrain"},ship:{component:b,name:"OrderQueryShip"},scenery:{component:x,name:"OrderQueryScenery"},homestay:{component:R,name:"OrderQueryHomestay"},restaurant:{component:I,name:"OrderQueryRestaurant"}}}},methods:{toOrderDetail:function(){this.$router.push({name:this.items[this.type].name,query:{orderNo:this.data.orderNo}})},handleDelete:function(){var t=this;return i()(n.a.mark(function e(){var a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={type:t.type,orderNo:[t.data.orderNo]},e.next=3,Object(c.i)(a);case 3:t.$emit("deleteItem",t.data);case 4:case"end":return e.stop()}},e,t)}))()},handleCancel:function(){var t=this;return i()(n.a.mark(function e(){var a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={type:t.type,orderNo:t.data.orderNo},e.prev=1,e.next=4,Object(c.f)(a);case 4:t.data.status=2,t.$emit("cancelItem",t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.$toast("取消订单失败");case 11:case"end":return e.stop()}},e,t,[[1,8]])}))()},handleRefund:function(){var t=this;return i()(n.a.mark(function e(){var a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={type:t.type,orderNo:t.data.orderNo},e.next=3,Object(c._8)(a);case 3:t.$set(t.data,"status",3);case 4:case"end":return e.stop()}},e,t)}))()}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("common-item",{attrs:{deletable:""},on:{delete:t.handleDelete}},[a("div",{staticClass:"order-bus-item-wrapper",on:{click:t.toOrderDetail}},[a("div",{staticClass:"order-bus-item-content"},[a("div",{staticClass:"order-bus-item-left"},[t.data.orderNo?a(t.items[t.type].component,{tag:"component",attrs:{data:t.data}}):t._e()],1),t._v(" "),a("div",{staticClass:"order-bus-item-right",class:t.statusClass},[a("span",{staticClass:"price"},[t._v("￥"+t._s(t.data.totalPrice))]),t._v(" "),a("span",{staticClass:"status-text"},[t._v(t._s(t.statusText))])])]),t._v(" "),a("order-status-btn-group",{staticClass:"order-bus-item-btn-group",attrs:{status:t.status,canRefund:t.canRefund,type:t.data.category||t.type},on:{cancelOrder:t.handleCancel,refundOrder:t.handleRefund,continueToPay:t.toOrderDetail}})],1)])},staticRenderFns:[]};var $=a("C7Lr")(w,k,!1,function(t){a("Lfxl")},null,null).exports,N={components:{LTab:o.a,LTabItem:o.b,OrderCommonItem:$},computed:{type:function(){return this.tabItems[this.selected].type},list:function(){return this.tabItems[this.selected].list}},data:function(){return{selected:0,tabItems:[{title:"大巴票",type:"bus",list:[]},{title:"船票",type:"boat",url:"https://yds.ziubao.com/allOrders.jsp?unionid="+this.$store.getters.wxUserInfo.unionid},{title:"飞机票",type:"plane",list:[]},{title:"火车票",type:"train",list:[]},{title:"专线-船票",type:"ship",list:[]},{title:"门票",type:"scenery",list:[]},{title:"民宿",type:"homestay",list:[]},{title:"订餐",type:"restaurant",list:[]}],pullDownRefresh:{threshold:50,stop:20},loaded:!1}},watch:{selected:function(t){this.tabItems[t].url?location.href=this.tabItems[t].url:this.getOrderList()}},created:function(){this.reorderTabItems()},mounted:function(){var t=this.$route.query.type;if(t)for(var e=0;e<this.tabItems.length;++e){this.tabItems[e].type===t&&(this.selected=e)}this.getOrderList()},methods:{getOrderList:function(){var t=this;return i()(n.a.mark(function e(){var a,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={type:t.tabItems[t.selected].type},t.loaded=!1,e.next=4,Object(c._6)(a);case 4:s=e.sent,t.tabItems[t.selected].list=s,setTimeout(function(){t.loaded=!0},500);case 7:case"end":return e.stop()}},e,t)}))()},toChangeUser:function(){var t=this;this.$store.commit("SHOW_LOGIN",{success:function(){t.getOrderList()}})},handleCancel:function(t){},handleDelete:function(t){var e=this.list.indexOf(t);e>-1&&(this.tabItems[this.selected].list=this.list.filter(function(t,a){return a!==e}))},reorderTabItems:function(){var t=this.$route.query.type,e=null,a=0;this.tabItems.forEach(function(s,n){s.type===t&&(e=s,a=n)}),e&&(this.tabItems.splice(a,1),this.tabItems.unshift(e))}}},T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main-page",{staticClass:"order-list-container",attrs:{back:"",title:"订单查询",pullDownRefresh:t.pullDownRefresh,data:t.list,isLoading:!t.loaded,noMatchText:"暂无订单数据"}},[a("l-tab",{model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.tabItems,function(e,s){return a("l-tab-item",{key:s},[a("span",[t._v(t._s(e.title))])])}),1),t._v(" "),a("template",{slot:"scroll"},[a("div",{staticClass:"order-list-content"},[t._l(t.list,function(e){return[a("order-common-item",{key:e.__ob__.dep.id,attrs:{data:e,type:t.type},on:{cancelItem:t.handleCancel,deleteItem:t.handleDelete}})]})],2)])],2)},staticRenderFns:[]};var L=a("C7Lr")(N,T,!1,function(t){a("8DWd")},null,null);e.default=L.exports},isZq:function(t,e){},r8BP:function(t,e){}});