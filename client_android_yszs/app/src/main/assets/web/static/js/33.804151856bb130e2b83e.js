webpackJsonp([33],{"0m2q":function(t,e){},"t/3M":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("4YfN"),a=i.n(s),n=i("lC5x"),c=i.n(n),o=i("J0Oq"),l=i.n(o),r=i("Hqhp"),d=i("gyMJ"),f={components:{LTab:r.a,LTabItem:r.b},props:{backMode:"goBack"},computed:{headerHeight:function(){return this.$refs["main-page"].headerHeight},tabOffsetTop:function(){if(this.$refs.tab.$el)return this.$refs.tab.$el.offsetTop},tabHeight:function(){if(this.$refs.tab.$el)return this.$refs.tab.$el.clientHeight},moreTickets:function(){return!!(this.detailData.ticketList&&this.detailData.ticketList.length>4)}},data:function(){return{detailData:{},tabList:["票种","图文详情","游玩指南","预订说明","优待政策"],selected:0,showFixedTab:!1,contentOffsetTop:[],isExpandMoreTickets:!1}},watch:{selected:function(t){},isExpandMoreTickets:function(t){this.calcContentOffsetTop()}},mounted:function(){this.getScenicDetail()},methods:{showTicketInfo:function(t){this.$store.commit("SHOW_DIALOG",t)},toShowMoreTickets:function(){this.isExpandMoreTickets=!this.isExpandMoreTickets},getScenicDetail:function(){var t=this;return l()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.L)({id:t.$route.params.id});case 2:t.detailData=e.sent,t.detailData.ticketList.filter(function(t,e){switch(t.periodType){case"day":t.showTicketName=t.ticketName+"-白天";break;case"night":t.showTicketName=t.ticketName+"-夜晚"}return t}),t.calcContentOffsetTop(),setTimeout(function(){t.calcContentOffsetTop()},1e3);case 6:case"end":return e.stop()}},e,t)}))()},onScroll:function(t){this.controlTabFixedShow(t.y),this.controlTabSelected(t.y)},controlTabFixedShow:function(t){-t>this.tabOffsetTop-this.headerHeight?this.showFixedTab=!0:this.showFixedTab=!1},controlTabSelected:function(t){for(var e=0;e<this.contentOffsetTop.length;++e)if(-t<this.contentOffsetTop[e]+this.tabHeight){this.selected=e;break}},calcContentOffsetTop:function(){var t=this;this.$nextTick(function(){for(var e in t.tabList)t.contentOffsetTop[e]=t.$refs["content-"+e].offsetTop})},onItem:function(){var t=this.contentOffsetTop[this.selected]-this.headerHeight-this.tabHeight;this.$refs["main-page"].calcHeaderOpacity(-t),this.controlTabFixedShow(-t),this.$refs["main-page"].scrollTo(0,-t)},toBooking:function(t){var e=a()({},this.detailData,{ticket:t});this.$store.commit("SET_SCENERY_DETAIL_DATA",e),this.$router.push({path:this.$route.fullPath+"/booking"})},toAddressMap:function(){var t=this.detailData,e=t.latitude,i=t.longitude,s=t.address,a=t.title;this.$router.push({path:this.$route.path+"/map",query:{keyword:s,lat:e,lng:i,name:a}})}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main-page",{ref:"main-page",staticClass:"scenery-detail-container",attrs:{back:"",headerClass:"gradient-style",title:t.detailData.title},on:{scroll:t.onScroll}},[t.showFixedTab?i("l-tab",{ref:"tab-fixed",staticClass:"scenery-detail-tab scenery-detail-tab-fixed",model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.tabList,function(e,s){return i("l-tab-item",{key:s,nativeOn:{click:function(e){return t.onItem(e)}}},[t._v(t._s(e)+"\n    ")])}),1):t._e(),t._v(" "),i("template",{slot:"scroll"},[i("l-header-image",{attrs:{images:t.detailData.images}},[i("div",{staticClass:"image-bottom-inner-title",attrs:{slot:"image-bottom-inner"},slot:"image-bottom-inner"},[t._v(t._s(t.detailData.title))])]),t._v(" "),i("div",{staticClass:"scenery-detail-header-bottom block-section"},[i("div",{staticClass:"item"},[i("div",{staticClass:"subtitle"},[t._v(t._s(t.detailData.subTitle))]),t._v(" "),i("l-labels",{attrs:{labels:t.detailData.labels}})],1),t._v(" "),i("div",{staticClass:"item",on:{click:t.toAddressMap}},[i("div",{staticClass:"address"},[i("i",{staticClass:"iconfont icon-ditu"}),t._v(" "),i("span",[t._v(t._s(t.detailData.address))])])])]),t._v(" "),i("l-tab",{ref:"tab",staticClass:"scenery-detail-tab",model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.tabList,function(e,s){return i("l-tab-item",{key:s,nativeOn:{click:function(e){return t.onItem(e)}}},[t._v(t._s(e)+"\n      ")])}),1),t._v(" "),i("div",{ref:"content-0",staticClass:"scenery-detail-content block-section"},[i("div",{staticClass:"section-title"},[i("span",[t._v("票种")])]),t._v(" "),i("div",{staticClass:"ticket-item-wrapper"},t._l(t.detailData.ticketList,function(e,s){return t.isExpandMoreTickets||s<6?i("div",{key:s,staticClass:"ticket-item"},[i("div",{staticClass:"left-wrapper"},[i("div",{staticClass:"title"},[t._v(t._s(e.showTicketName||e.ticketName))]),t._v(" "),i("div",{staticClass:"sub-title"},[e.soldCounts?i("div",{staticClass:"sold-counts"},[t._v("已售"+t._s(e.soldCounts))]):i("div",{staticClass:"sold-counts new"},[t._v("新品")]),t._v(" "),e.ticketInfo?i("span",{staticClass:"ticket-info",on:{click:function(i){return t.showTicketInfo(e.ticketInfo)}}},[t._v("票种说明>")]):t._e()])]),t._v(" "),i("div",{staticClass:"right-wrapper"},[i("div",{staticClass:"price-wrapper"},[e.guidePrice?i("span",{staticClass:"original-price"},[t._v("\n                ￥"),i("span",{staticClass:"price-num"},[t._v(t._s(e.guidePrice))])]):t._e(),t._v(" "),i("span",{staticClass:"price"},[t._v("\n                ￥"),i("span",{staticClass:"price-num"},[t._v(t._s(e.price))])])]),t._v(" "),i("div",{staticClass:"topay-btn",on:{click:function(i){return t.toBooking(e)}}},[t._v("立即预订")])])]):t._e()}),0),t._v(" "),t.moreTickets?i("div",{staticClass:"ticket-type-more-wrapper",on:{click:t.toShowMoreTickets}},[i("span",[t._v(t._s(t.isExpandMoreTickets?"收起":"显示更多票种"))])]):t._e(),t._v(" "),t.detailData.ticketList&&0!==t.detailData.ticketList.length?t._e():i("div",{staticClass:"content-empty"},[t._v("暂不支持网上预订")])]),t._v(" "),i("div",{ref:"content-1",staticClass:"scenery-detail-content block-section"},[i("div",{staticClass:"section-title"},[i("span",[t._v("图文详情")])]),t._v(" "),t.detailData.contents?i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.detailData.contents)}}):i("div",{staticClass:"content-empty"},[t._v("暂无图文详情信息")])]),t._v(" "),i("div",{ref:"content-2",staticClass:"scenery-detail-content block-section"},[t.detailData.playGuide?i("div",{},[i("div",{staticClass:"section-title"},[t._v("游玩指南")]),t._v(" "),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.detailData.playGuide)}})]):i("div",{staticClass:"content-empty"},[t._v("暂无游玩指南")])]),t._v(" "),i("div",{ref:"content-3",staticClass:"scenery-detail-content block-section"},[t.detailData.notices&&0!==t.detailData.notices.length?i("div",{staticClass:"notice-content"},t._l(t.detailData.notices,function(e,s){return i("div",{key:s,staticClass:"notice-item"},[i("div",{staticClass:"title"},[t._v(t._s(e.define))]),t._v(" "),i("div",{staticClass:"notice-content",domProps:{innerHTML:t._s(e.notice)}})])}),0):i("div",{staticClass:"content-empty"},[t._v("暂无预订说明信息")])]),t._v(" "),i("div",{ref:"content-4",staticClass:"scenery-detail-content block-section"},[i("div",{staticClass:"section-title"},[i("span",[t._v("优待政策")])]),t._v(" "),t.detailData.preferentialPolicy?i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.detailData.preferentialPolicy)}}):i("div",{staticClass:"content-empty"},[t._v("暂无优待政策")])])],1)],2)},staticRenderFns:[]};var p=i("C7Lr")(f,v,!1,function(t){i("0m2q")},null,null);e.default=p.exports}});