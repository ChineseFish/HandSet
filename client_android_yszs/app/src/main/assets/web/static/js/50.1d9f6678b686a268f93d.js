webpackJsonp([50],{roHj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("lC5x"),a=i.n(s),r=i("J0Oq"),c=i.n(r),n=i("HzJ8"),o=i.n(n),p=i("aA9S"),l=i.n(p),u=i("4YfN"),h=i.n(u),d=i("N3LN"),v=i("gyMJ"),m=i("fUgm"),f=i("HNeU"),T=i("X2Oc"),y={components:{DatepickBar:d.a,TicketTypeChoose:f.a},props:{tripName:String,tripId:[String,Number],type:String,time:String,fromType:String},computed:h()({},Object(m.b)(["queryHistory","queryDate","canWebBuyDays"]),{travel:function(){return this.tripName},id:function(){return this.tripId},activeMsg:function(){return Object(T.b)(this.dateTime,2)&&502===this.id?"该日班次6:30开售":""}}),data:function(){return{dateTime:this.time,list:[],isLoaded:!1,showTicketTypes:!1,choosedItem:{},ticketSeatsInfo:[]}},created:function(){},mounted:function(){this.dateTime=this.time||this.queryDate,this.getTravelLineShipList()},watch:{dateTime:function(){this.getTravelLineShipList()}},methods:{toShowTicketSeats:function(t){0!==Number(t.surplusTicket)?(this.choosedItem=t,this.ticketSeatsInfo=t.showShipPriceList,this.showTicketTypes=!0):this.$toast("余票不足，请选择其他班次")},chooseTicket:function(t){var e=0,i=!0,s=!1,a=void 0;try{for(var r,c=o()(this.choosedItem.shipPriceList);!(i=(r=c.next()).done);i=!0){var n=r.value;t.seatTypeCode===n.seatTypeCode&&"02"===n.ticketTypeCode&&(e=n.price)}}catch(t){s=!0,a=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw a}}this.showTicketTypes=!1;var p=l()({},this.choosedItem,h()({category:"ship",queryDate:this.dateTime,childPrice:e},t));this.$store.commit("SET_DETAILDATA",{type:"ship",value:p}),this.$router.push({path:"ship-list/detail",params:{shipInfo:p}})},getTravelLineShipList:function(){var t=this;return c()(a.a.mark(function e(){var i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&t.dateTime){e.next=2;break}return e.abrupt("return");case 2:return i={routeID:t.id,date:t.dateTime},t.isLoaded=!1,e.next=6,Object(v.W)(i,t.fromType);case 6:s=e.sent,t.isLoaded=!0,s.filter(function(e,i,s){var a=Number.MAX_VALUE;e.showShipPriceList=e.shipPriceList.filter(function(t){if("儿童票"===t.ticketType||"半票"===t.ticketType)return!1;"成人票"===t.ticketType&&(t.ticketType="通票");var e=parseInt(t.price);return a=a>e?e:a,t}),0===e.shipPriceList.length?e.minPrice=0:e.minPrice=a,"travel-line-ship-pts"===t.type&&"01"===e.shipTypeCode&&(s.splice(i,1),s.unshift(e))}),t.list=s;case 11:case"end":return e.stop()}},e,t)}))()}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main-page",{ref:"main-page",staticClass:"tavel-line-ticket-list",attrs:{back:"",title:this.travel||"旅游专线列表",isLoading:!t.isLoaded,data:t.list}},[i("datepick-bar",{attrs:{canWebBuyDays:t.canWebBuyDays},model:{value:t.dateTime,callback:function(e){t.dateTime=e},expression:"dateTime"}}),t._v(" "),t.activeMsg?i("notication-bar",{attrs:{text:t.activeMsg}}):t._e(),t._v(" "),i("section",{staticClass:"tavel-line-ticket-list-wrapper",attrs:{slot:"scroll"},slot:"scroll"},t._l(t.list,function(e,s){return i("div",{key:s,staticClass:"tavel-line-ticket-list-item",on:{click:function(i){return t.toShowTicketSeats(e)}}},[i("div",{staticClass:"tavel-line-ticket-list-item-content"},[i("div",{staticClass:"from-section"},[i("div",{staticClass:"from-station"},[t._v(t._s(e.fromStationName))]),t._v(" "),i("div",{staticClass:"from-time"},[t._v(t._s(e.fromTime))])]),t._v(" "),i("div",{staticClass:"icon-arrow"},[i("div",{staticClass:"arrow-top"},[t._v(t._s(e.shipType))]),t._v(" "),i("i",{staticClass:"city-to"})]),t._v(" "),i("div",{staticClass:"to-section"},[i("div",{staticClass:"to-station"},[t._v(t._s(e.toStationName))])]),t._v(" "),i("div",{staticClass:"other-section"},[i("div",{staticClass:"surplus-ticket"},[i("span",[t._v("剩余:")]),t._v(" "),i("span",{staticClass:"cnt"},[t._v(t._s(e.surplusTicket))]),t._v(" "),"有"!==e.surplusTicket?i("span",[t._v(" 张")]):t._e()]),t._v(" "),e.minPrice?i("div",{staticClass:"price-wrapper"},[i("span",{staticClass:"price"},[t._v("￥"+t._s(e.minPrice))]),t._v(" "),i("span",{staticClass:"price-text"},[t._v("起")])]):t._e()])])])}),0),t._v(" "),i("ticket-type-choose",{attrs:{show:t.showTicketTypes,ticketTypes:t.ticketSeatsInfo},on:{"update:show":function(e){t.showTicketTypes=e},choose:t.chooseTicket}})],1)},staticRenderFns:[]};var _=i("C7Lr")(y,k,!1,function(t){i("vKeA")},null,null);e.default=_.exports},vKeA:function(t,e){}});