webpackJsonp([18],{"+3Gz":function(t,e){},"8NOJ":function(t,e,a){"use strict";var i=a("DMPO"),s={components:{swiper:i.swiper,swiperSlide:i.swiperSlide},props:{image:"",imageInfo:{type:Array,default:function(){return[]}}},computed:{swiperImages:function(){var t=[];return this.imageInfo.forEach(function(e,a){t=t.concat(e.images)}),t}},data:function(){return{swiperOption:{pagination:{el:".swiper-pagination"}},showMoreImages:!1}},watch:{imageInfo:function(t){}},methods:{onImage:function(){this.$store.commit("SET_HOMESTAY_IMAGES_INFO",this.imageInfo),this.$router.push({path:"/homestay/more-images"})},onerror:function(){}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail-header-image"},[t.swiperImages.length>0?a("swiper",{staticClass:"swiper-wrapper",attrs:{options:t.swiperOption},nativeOn:{click:function(e){return t.onImage(e)}}},[t._l(t.swiperImages,function(t,e){return a("swiper-slide",{key:e},[a("img",{staticClass:"image",attrs:{src:t}})])}),t._v(" "),a("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2):a("img",{staticClass:"image",attrs:{src:t.image,alt:""}}),t._v(" "),t.imageInfo.length>0?a("div",{staticClass:"more-images",on:{click:t.onImage}},[t._v("- 查看多图 -")]):t._e()],1)},staticRenderFns:[]};var c=a("C7Lr")(s,n,!1,function(t){a("o8Hv")},null,null);e.a=c.exports},M25e:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("lC5x"),s=a.n(i),n=a("rVsN"),c=a.n(n),o=a("J0Oq"),r=a.n(o),l=a("4YfN"),d=a.n(l),u=a("ViAG"),h=a("9ER+"),v=a("gyMJ"),m=a("8NOJ"),f=a("iLhm"),_=a("fUgm"),p=["日","一","二","三","四","五","六"],k={components:{Calendar:u.a,DetailHeaderImage:m.a,TopayBar:f.a},computed:d()({},Object(_.b)(["checkInDate","checkOutDate"]),{checkInTimeStamp:function(){return+new Date(this.checkInDate)/1e3},checkOutTimeStamp:function(){return+new Date(this.checkOutDate)/1e3},checkInWeekday:function(){return"周"+p[new Date(this.checkInDate).getDay()]},checkOutWeekday:function(){return"周"+p[new Date(this.checkOutDate).getDay()]},duringDays:function(){return this.checkInDate&&this.checkOutDate?(this.checkOutTimeStamp-this.checkInTimeStamp)/86400:0},totalPrice:function(){if(!this.checkInDate||!this.checkOutDate||!this.rmCalendarObj)return 0;for(var t=0,e=this.checkInTimeStamp;e<this.checkOutTimeStamp;)t+=this.rmCalendarObj[e].price,e+=86400;return t}}),data:function(){return{show:!1,rmCalendarObj:null,unableBookArr:[],detailData:{},facilityInfo:{},serviceInfo:[],showFacilityInfo:!1,showServiceInfo:!1,showBedTypes:!1}},mounted:function(){var t=this;this.getHomestayDetail().then(function(){t.getPrice()})},methods:{checkIn:function(){this.show=!0},checkOut:function(){this.show=!0},setHomestayDate:function(t,e){this.$store.commit("SET_CHECK_IN_DATE",t),this.$store.commit("SET_CHECK_OUT_DATE",e)},filterRoomCalendar:function(t){var e=this,a={};return t.filter(function(t,i,s){var n=t.date.split(" ")[0],c=new Date(n).getTime()/1e3;t.issell||e.unableBookArr.push(c),a[c]=t}),a},filterFacilityInfo:function(t){var e=this;this.facilityInfo={},t.forEach(function(t){e.facilityInfo[t.groupName]||(e.facilityInfo[t.groupName]=[]),e.facilityInfo[t.groupName].push(t.name)})},choosed:function(t,e){this.setHomestayDate(Object(h.f)(t),Object(h.f)(e))},getHomestayDetail:function(){var t=this;return r()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$route.params.id){e.next=2;break}return e.abrupt("return",c.a.reject(Error("id不能为空")));case 2:return e.next=4,Object(v.o)({id:t.$route.params.id});case 4:t.detailData=e.sent,t.detailData.facilityInfo&&t.detailData.facilityInfo.length>0?(t.filterFacilityInfo(t.detailData.facilityInfo),t.serviceInfo=t.detailData.serviceInfo):t.serviceInfo=[];case 6:case"end":return e.stop()}},e,t)}))()},getPrice:function(){var t=this;return r()(s.a.mark(function e(){var a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.detailData.homestayId,e.next=3,Object(v.s)({homestayId:a,roomId:t.detailData.id});case 3:i=e.sent,t.rmCalendarObj=t.filterRoomCalendar(i);case 5:case"end":return e.stop()}},e,t)}))()},onAddress:function(){var t=this.detailData,e=t.address,a=t.latitude,i=t.longitude,s=t.name;this.$router.push({path:"/homestay/map",query:{keyword:e,lat:a,lng:i,title:s}})},toOrder:function(){this.checkInDate?(this.$store.commit("SET_DETAILDATA",{value:d()({},this.detailData,{totalPrice:this.totalPrice,checkInDate:this.checkInDate,checkOutDate:this.checkOutDate}),type:"homestay"}),this.$router.push({path:this.$route.path+"/booking"})):this.$toast("请选择入住日期")}}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main-page",{staticClass:"homestay-detail-wrapper",attrs:{title:t.detailData.name,back:"",headerClass:"gradient-style"}},[a("template",{slot:"scroll"},[a("detail-header-image",{attrs:{image:t.detailData.image,imageInfo:t.detailData.imageInfo}}),t._v(" "),a("div",{staticClass:"block-section header-title-section"},[a("l-tag-wrapper",{attrs:{tagList:t.detailData.tagList}}),t._v(" "),a("div",{staticClass:"title"},[t._v("\n        "+t._s(t.detailData.name)+"\n      ")]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"line"},[a("b",{staticClass:"bold"},[t._v(t._s(t.detailData.layout))]),t._v(" "),a("span",[t._v(t._s(" /"+t.detailData.houseSize+"平/"))]),t._v(" "),a("b",[t._v(t._s(t.detailData.bedType)+"("+t._s(t.detailData.bedNum)+"张)")]),t._v(" "),a("i",{staticClass:"iconfont icon-wenhao",on:{click:function(e){t.showBedTypes=!0}}})])])],1),t._v(" "),a("div",{directives:[{name:"is-link",rawName:"v-is-link"}],staticClass:"block-section",on:{click:t.onAddress}},[a("div",{staticClass:"section-title"},[t._v("\n        地址\n      ")]),t._v(" "),a("div",[t._v(t._s(t.detailData.address))])]),t._v(" "),a("div",{staticClass:"block-section"},[a("div",{staticClass:"section-title"},[t._v("\n        房屋描述\n      ")]),t._v(" "),a("div",{domProps:{innerHTML:t._s(t.detailData.description)}})]),t._v(" "),a("div",{staticClass:"block-section"},[a("div",{staticClass:"section-title"},[t._v("\n        入离日期\n      ")]),t._v(" "),a("div",{staticClass:"date-choose-content"},[a("div",{staticClass:"checkin-content",on:{click:t.checkIn}},[a("div",{staticClass:"title"},[t._v("入住")]),t._v(" "),t.checkInDate?a("div",{staticClass:"have-date"},[t._v(t._s(t._f("dateFormat")(t.checkInDate))),a("span",{staticClass:"weekday"},[t._v(t._s(t.checkInWeekday))])]):a("div",{staticClass:"no-date"},[t._v("请选择入住日期")])]),t._v(" "),a("div",{staticClass:"homestay-during-days"},[t._v(t._s(t.duringDays)+"晚")]),t._v(" "),a("div",{staticClass:"checkout-content",on:{click:t.checkOut}},[a("div",{staticClass:"title"},[t._v("离店")]),t._v(" "),t.checkInDate?a("div",{staticClass:"have-date"},[t._v(t._s(t._f("dateFormat")(t.checkOutDate))),a("span",{staticClass:"weekday"},[t._v(t._s(t.checkOutWeekday))])]):a("div",{staticClass:"no-date"},[t._v("请选择离店日期")])])])]),t._v(" "),a("div",{staticClass:"block-section"},[a("div",{staticClass:"section-title"},[t._v("\n        入住须知\n      ")]),t._v(" "),a("div",{staticClass:"content"},[t.detailData.checkInTime?a("div",[t._v("入住时间："+t._s(t.detailData.checkInTime))]):t._e(),t._v(" "),t.detailData.checkOutTime?a("div",[t._v("退房时间："+t._s(t.detailData.checkOutTime))]):t._e(),t._v(" "),t.detailData.receptionTime?a("div",[t._v("接待时间："+t._s(t.detailData.receptionTime))]):t._e(),t._v(" "),a("div",[t._v("退订说明："),a("span",{staticClass:"refund-instruction"},[t._v(t._s(t.detailData.cancelText))])])])]),t._v(" "),a("div",{staticClass:"block-section other-section"},[a("div",{directives:[{name:"is-link",rawName:"v-is-link"}],staticClass:"item",on:{click:function(e){t.showFacilityInfo=!0}}},[t._v("配套设施")]),t._v(" "),a("div",{directives:[{name:"is-link",rawName:"v-is-link"}],staticClass:"item",on:{click:function(e){t.showServiceInfo=!0}}},[t._v("额外服务")])])],1),t._v(" "),a("topay-bar",{attrs:{slot:"bottom",payText:"立即预定"},on:{commit:function(e){return t.toOrder()}},slot:"bottom",model:{value:t.totalPrice,callback:function(e){t.totalPrice=e},expression:"totalPrice"}}),t._v(" "),a("calendar",{attrs:{show:t.show,checkInTimeStamp:t.checkInTimeStamp,checkOutTimeStamp:t.checkOutTimeStamp,unableBookArr:t.unableBookArr,rmCalendarObj:t.rmCalendarObj},on:{"update:show":function(e){t.show=e},choosed:t.choosed}}),t._v(" "),a("mu-dialog",{attrs:{open:t.showBedTypes,title:"铺位"},on:{"update:open":function(e){t.showBedTypes=e}}},t._l(t.detailData.bedInfo,function(e,i){return a("div",{key:i,staticClass:"beds"},[t._v("\n      - "+t._s(e.name)+" | "+t._s(e.width)+"米*"+t._s(e.length)+"米 | "+t._s(e.quantity)+"张\n    ")])}),0),t._v(" "),a("mu-dialog",{attrs:{open:t.showFacilityInfo,title:"配套设施",scrollable:""},on:{"update:open":function(e){t.showFacilityInfo=e}}},t._l(t.facilityInfo,function(e,i){return a("div",{key:i},[a("div",[t._v(t._s(i))]),t._v(" "),a("l-tag-wrapper",{attrs:{tagList:e,itemClass:"font-size-12"}})],1)}),0),t._v(" "),a("mu-dialog",{attrs:{open:t.showServiceInfo,title:"额外服务"},on:{"update:open":function(e){t.showServiceInfo=e}}},t._l(t.serviceInfo,function(e,i){return a("div",{key:i},[a("span",[t._v(t._s(e.name)+": ")]),t._v(" "),a("span",{staticStyle:{color:"#333"}},[t._v(t._s(e.description))])])}),0)],2)},staticRenderFns:[]};var D=a("C7Lr")(k,I,!1,function(t){a("+3Gz")},null,null);e.default=D.exports},o8Hv:function(t,e){}});